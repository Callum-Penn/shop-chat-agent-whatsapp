[shop-chat-agent-whatsapp] [2025-07-28 12:33:22] npm warn Unknown user config "auto-install-peers". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:22] npm warn Unknown user config "shamefully-hoist". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:22] npm warn Unknown user config "enable-pre-post-scripts". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:23] 
[shop-chat-agent-whatsapp] [2025-07-28 12:32:32] npm warn Unknown user config "auto-install-peers". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:32] npm warn Unknown user config "shamefully-hoist". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:32] npm warn Unknown user config "enable-pre-post-scripts". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:33] 
[shop-chat-agent-whatsapp] [2025-07-28 12:32:33] > shop-chat-agent@1.0.18 start
[shop-chat-agent-whatsapp] [2025-07-28 12:33:23] > shop-chat-agent@1.0.18 start
[shop-chat-agent-whatsapp] [2025-07-28 12:33:23] > npx prisma generate && npx prisma db push && remix-serve ./build/server/index.js --host 0.0.0.0 --port $PORT
[shop-chat-agent-whatsapp] [2025-07-28 12:32:33] > npx prisma generate && npx prisma db push && remix-serve ./build/server/index.js --host 0.0.0.0 --port $PORT
[shop-chat-agent-whatsapp] [2025-07-28 12:32:33] 
[shop-chat-agent-whatsapp] [2025-07-28 12:32:33] npm warn Unknown env config "auto-install-peers". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:33] npm warn Unknown env config "enable-pre-post-scripts". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:33] npm warn Unknown env config "shamefully-hoist". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:33] npm warn Unknown user config "auto-install-peers". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:33] npm warn Unknown user config "shamefully-hoist". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:33] npm warn Unknown user config "enable-pre-post-scripts". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:35] Prisma schema loaded from prisma/schema.prisma
[shop-chat-agent-whatsapp] [2025-07-28 12:33:23] 
[shop-chat-agent-whatsapp] [2025-07-28 12:33:23] npm warn Unknown env config "auto-install-peers". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:23] npm warn Unknown env config "enable-pre-post-scripts". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:23] npm warn Unknown env config "shamefully-hoist". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:23] npm warn Unknown user config "auto-install-peers". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:23] npm warn Unknown user config "shamefully-hoist". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:23] npm warn Unknown user config "enable-pre-post-scripts". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:25] Prisma schema loaded from prisma/schema.prisma
[shop-chat-agent-whatsapp] [2025-07-28 12:33:25] Warning: You did not specify an output path for your `generator` in schema.prisma. This behavior is deprecated and will no longer be supported in Prisma 7.0.0. To learn more visit https://pris.ly/cli/output-path
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] 
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] ✔ Generated Prisma Client (v6.6.0) to ./node_modules/@prisma/client in 182ms
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] 
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] 
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] Tip: Want real-time updates to your database without manual polling? Discover how with Pulse: https://pris.ly/tip-0-pulse
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] 
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] npm warn Unknown env config "auto-install-peers". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] npm warn Unknown env config "enable-pre-post-scripts". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] npm warn Unknown env config "shamefully-hoist". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] npm warn Unknown user config "auto-install-peers". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] npm warn Unknown user config "shamefully-hoist". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:26] npm warn Unknown user config "enable-pre-post-scripts". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:29] Prisma schema loaded from prisma/schema.prisma
[shop-chat-agent-whatsapp] [2025-07-28 12:33:29] Datasource "db": PostgreSQL database "defaultdb", schema "public" at "shop-chat-agent-db-do-user-24130937-0.e.db.ondigitalocean.com:25060"
[shop-chat-agent-whatsapp] [2025-07-28 12:33:29] 
[shop-chat-agent-whatsapp] [2025-07-28 12:33:29] The database is already in sync with the Prisma schema.
[shop-chat-agent-whatsapp] [2025-07-28 12:33:29] 
[shop-chat-agent-whatsapp] [2025-07-28 12:33:29] Running generate... (Use --skip-generate to skip the generators)
[shop-chat-agent-whatsapp] [2025-07-28 12:33:29] Warning: You did not specify an output path for your `generator` in schema.prisma. This behavior is d
✔ Generated Prisma Client (v6.6.0) to ./node_modules/@prisma/client in 140ms
[shop-chat-agent-whatsapp] [2025-07-28 12:33:29] 
[shop-chat-agent-whatsapp] [2025-07-28 12:33:30] ┌─────────────────────────────────────────────────────────┐
[shop-chat-agent-whatsapp] [2025-07-28 12:33:30] │  Update available 6.6.0 -> 6.12.0                       │
[shop-chat-agent-whatsapp] [2025-07-28 12:33:30] │  Run the following to update                            │
[shop-chat-agent-whatsapp] [2025-07-28 12:33:30] │    npm i --save-dev prisma@latest                       │
[shop-chat-agent-whatsapp] [2025-07-28 12:33:30] │    npm i @prisma/client@latest                          │
[shop-chat-agent-whatsapp] [2025-07-28 12:33:30] └─────────────────────────────────────────────────────────┘
[shop-chat-agent-whatsapp] [2025-07-28 12:33:34] [shopify-api/INFO] version 11.12.0, environment Remix
[shop-chat-agent-whatsapp] [2025-07-28 12:33:34] [remix-serve] http://localhost:8080 (http://10.244.21.89:8080)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:33] POST /api/whatsapp-webhook 200 - - 15.079 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:34:33] POST /api/whatsapp-webhook 200 - - 2.357 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] WhatsApp: Error getting shop domain from database: PrismaClientValidationError: 
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] Invalid `prisma.session.findMany()` invocation:
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] 
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]   orderBy: {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     createdAt: "desc",
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     ~~~~~~~~~
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   id?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   shop?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   state?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   isOnline?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   scope?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   expires?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   accessToken?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   userId?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   firstName?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   lastName?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   email?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   accountOwner?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   locale?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   collaborator?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] ?   emailVerified?: SortOrder | SortOrderInput
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]   }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] 
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] Unknown argument `createdAt`. Available options are marked with ?.
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at An (/workspace/node_modules/@prisma/client/runtime/library.js:29:1363)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at zn.handleRequestError (/workspace/node_modules/@prisma/client/runtime/library.js:121:7102)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at zn.handleAndLogRequestError (/workspace/node_modules/@prisma/client/runtime/library.js:121:6784)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at zn.request (/workspace/node_modules/@prisma/client/runtime/library.js:121:6491)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at l (/workspace/node_modules/@prisma/client/runtime/library.js:130:9778)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at action$3 (file:///workspace/build/server/index.js?t=315532801000:866:26)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at Object.callRouteAction (/workspace/node_modules/@remix-run/server-runtime/dist/data.js:36:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at /workspace/node_modules/@remix-run/router/router.ts:4934:19
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at callLoaderOrAction (/workspace/node_modules/@remix-run/router/router.ts:4998:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at async Promise.all (index 0) {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]   clientVersion: '6.6.0'
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] WhatsApp: Attempting to connect to MCP servers...
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] Connecting to MCP server at your-store.myshopify.com/api/mcp
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] Failed to connect to MCP server:  TypeError: Invalid URL
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at new URL (node:internal/url:819:25)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at new Request (/workspace/node_modules/@remix-run/web-fetch/src/request.js:81:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at /workspace/node_modules/@remix-run/web-fetch/src/fetch.js:43:19
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at new Promise (<anonymous>)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at fetch (/workspace/node_modules/@remix-run/web-fetch/src/fetch.js:41:9)
[shop-chat-agent-whatsapp] [2025-07-28 12:32:35] Warning: You did not specify an output path for your `generator` in schema.prisma. This behavior is deprecated and will no longer be supported in Prisma 7.0.0. To learn more visit https://pris.ly/cli/output-path
[shop-chat-agent-whatsapp] [2025-07-28 12:32:36] 
[shop-chat-agent-whatsapp] [2025-07-28 12:32:36] ✔ Generated Prisma Client (v6.6.0) to ./node_modules/@prisma/client in 183ms
[shop-chat-agent-whatsapp] [2025-07-28 12:32:36] 
[shop-chat-agent-whatsapp] [2025-07-28 12:32:36] Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)
[shop-chat-agent-whatsapp] [2025-07-28 12:32:36] 
[shop-chat-agent-whatsapp] [2025-07-28 12:32:36] Tip: Need your database queries to be 1000x faster? Accelerate offers you that and more: https://pris.ly/tip-2-accelerate
[shop-chat-agent-whatsapp] [2025-07-28 12:32:36] 
[shop-chat-agent-whatsapp] [2025-07-28 12:32:37] npm warn Unknown env config "auto-install-peers". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:37] npm warn Unknown env config "enable-pre-post-scripts". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:37] npm warn Unknown env config "shamefully-hoist". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:37] npm warn Unknown user config "auto-install-peers". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:37] npm warn Unknown user config "shamefully-hoist". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:37] npm warn Unknown user config "enable-pre-post-scripts". This will stop working in the next major version of npm.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:39] Prisma schema loaded from prisma/schema.prisma
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at MCPClient._makeJsonRpcRequest (file:///workspace/build/server/index.js?t=315532801000:800:28)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at MCPClient.connectToStorefrontServer (file:///workspace/build/server/index.js?t=315532801000:666:35)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at action$3 (file:///workspace/build/server/index.js?t=315532801000:908:46)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at Object.callRouteAction (/workspace/node_modules/@remix-run/server-runtime/dist/data.js:36:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]     at /workspace/node_modules/@remix-run/router/router.ts:4934:19 {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]   code: 'ERR_INVALID_URL',
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45]   input: 'your-store.myshopify.com/api/mcp'
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:45] WhatsApp: Failed to connect to MCP servers, continuing without tools: Invalid URL
[shop-chat-agent-whatsapp] [2025-07-28 12:34:51] POST /api/whatsapp-webhook 200 - - 5788.078 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:34:52] POST /api/whatsapp-webhook 200 - - 2.017 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:40:37] POST /api/whatsapp-webhook 200 - - 3.545 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:40:37] POST /api/whatsapp-webhook 200 - - 1.884 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:32:39] Datasource "db": PostgreSQL database "defaultdb", schema "public" at "shop-chat-agent-db-do-user-24130937-0.e.db.ondigitalocean.com:25060"
[shop-chat-agent-whatsapp] [2025-07-28 12:32:39] 
[shop-chat-agent-whatsapp] [2025-07-28 12:32:39] The database is already in sync with the Prisma schema.
[shop-chat-agent-whatsapp] [2025-07-28 12:32:39] 
[shop-chat-agent-whatsapp] [2025-07-28 12:32:39] Running generate... (Use --skip-generate to skip the generators)
[shop-chat-agent-whatsapp] [2025-07-28 12:32:40] Warning: You did not specify an output path for your `generator` in schema.prisma. This behavior is d
✔ Generated Prisma Client (v6.6.0) to ./node_modules/@prisma/client in 184ms
[shop-chat-agent-whatsapp] [2025-07-28 12:32:40] 
[shop-chat-agent-whatsapp] [2025-07-28 12:32:40] ┌─────────────────────────────────────────────────────────┐
[shop-chat-agent-whatsapp] [2025-07-28 12:32:40] │  Update available 6.6.0 -> 6.12.0                       │
[shop-chat-agent-whatsapp] [2025-07-28 12:32:40] │  Run the following to update                            │
[shop-chat-agent-whatsapp] [2025-07-28 12:32:40] │    npm i --save-dev prisma@latest                       │
[shop-chat-agent-whatsapp] [2025-07-28 12:32:40] │    npm i @prisma/client@latest                          │
[shop-chat-agent-whatsapp] [2025-07-28 12:32:40] └─────────────────────────────────────────────────────────┘
[shop-chat-agent-whatsapp] [2025-07-28 12:32:44] [shopify-api/INFO] version 11.12.0, environment Remix
[shop-chat-agent-whatsapp] [2025-07-28 12:32:44] [remix-serve] http://localhost:8080 (http://10.244.17.145:8080)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] WhatsApp: Error getting shop domain from database: PrismaClientValidationError: 
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] Invalid `prisma.session.findMany()` invocation:
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] 
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]   orderBy: {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     createdAt: "desc",
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     ~~~~~~~~~
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   id?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   shop?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   state?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   isOnline?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   scope?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   expires?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   accessToken?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   userId?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   firstName?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   lastName?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   email?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   accountOwner?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   locale?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   collaborator?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] ?   emailVerified?: SortOrder | SortOrderInput
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]   }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] 
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] Unknown argument `createdAt`. Available options are marked with ?.
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at An (/workspace/node_modules/@prisma/client/runtime/library.js:29:1363)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at zn.handleRequestError (/workspace/node_modules/@prisma/client/runtime/library.js:121:7102)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at zn.handleAndLogRequestError (/workspace/node_modules/@prisma/client/runtime/library.js:121:6784)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at zn.request (/workspace/node_modules/@prisma/client/runtime/library.js:121:6491)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at l (/workspace/node_modules/@prisma/client/runtime/library.js:130:9778)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at action$3 (file:///workspace/build/server/index.js?t=315532801000:866:26)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at Object.callRouteAction (/workspace/node_modules/@remix-run/server-runtime/dist/data.js:36:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at /workspace/node_modules/@remix-run/router/router.ts:4934:19
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at callLoaderOrAction (/workspace/node_modules/@remix-run/router/router.ts:4998:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at async Promise.all (index 0) {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]   clientVersion: '6.6.0'
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] WhatsApp: Attempting to connect to MCP servers...
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] Connecting to MCP server at your-store.myshopify.com/api/mcp
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] Failed to connect to MCP server:  TypeError: Invalid URL
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at new URL (node:internal/url:819:25)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at new Request (/workspace/node_modules/@remix-run/web-fetch/src/request.js:81:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at /workspace/node_modules/@remix-run/web-fetch/src/fetch.js:43:19
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at new Promise (<anonymous>)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at fetch (/workspace/node_modules/@remix-run/web-fetch/src/fetch.js:41:9)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at MCPClient._makeJsonRpcRequest (file:///workspace/build/server/index.js?t=315532801000:800:28)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at MCPClient.connectToStorefrontServer (file:///workspace/build/server/index.js?t=315532801000:666:35)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at action$3 (file:///workspace/build/server/index.js?t=315532801000:908:46)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at Object.callRouteAction (/workspace/node_modules/@remix-run/server-runtime/dist/data.js:36:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]     at /workspace/node_modules/@remix-run/router/router.ts:4934:19 {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]   code: 'ERR_INVALID_URL',
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13]   input: 'your-store.myshopify.com/api/mcp'
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:13] WhatsApp: Failed to connect to MCP servers, continuing without tools: Invalid URL
[shop-chat-agent-whatsapp] [2025-07-28 12:34:16] POST /api/whatsapp-webhook 200 - - 3403.872 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:34:17] POST /api/whatsapp-webhook 200 - - 2.153 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:34:17] POST /api/whatsapp-webhook 200 - - 2.255 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:34:17] POST /api/whatsapp-webhook 200 - - 1.846 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] WhatsApp: Error getting shop domain from database: PrismaClientValidationError: 
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] Invalid `prisma.session.findMany()` invocation:
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] 
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]   orderBy: {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     createdAt: "desc",
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     ~~~~~~~~~
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   id?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   shop?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   state?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   isOnline?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   scope?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   expires?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   accessToken?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   userId?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   firstName?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   lastName?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   email?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   accountOwner?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   locale?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   collaborator?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] ?   emailVerified?: SortOrder | SortOrderInput
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]   }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] 
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] Unknown argument `createdAt`. Available options are marked with ?.
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at An (/workspace/node_modules/@prisma/client/runtime/library.js:29:1363)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at zn.handleRequestError (/workspace/node_modules/@prisma/client/runtime/library.js:121:7102)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at zn.handleAndLogRequestError (/workspace/node_modules/@prisma/client/runtime/library.js:121:6784)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at zn.request (/workspace/node_modules/@prisma/client/runtime/library.js:121:6491)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at l (/workspace/node_modules/@prisma/client/runtime/library.js:130:9778)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at action$3 (file:///workspace/build/server/index.js?t=315532801000:866:26)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at Object.callRouteAction (/workspace/node_modules/@remix-run/server-runtime/dist/data.js:36:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at /workspace/node_modules/@remix-run/router/router.ts:4934:19
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at callLoaderOrAction (/workspace/node_modules/@remix-run/router/router.ts:4998:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at async Promise.all (index 0) {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]   clientVersion: '6.6.0'
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] WhatsApp: Attempting to connect to MCP servers...
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] Connecting to MCP server at your-store.myshopify.com/api/mcp
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] Failed to connect to MCP server:  TypeError: Invalid URL
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at new URL (node:internal/url:819:25)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at new Request (/workspace/node_modules/@remix-run/web-fetch/src/request.js:81:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at /workspace/node_modules/@remix-run/web-fetch/src/fetch.js:43:19
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at new Promise (<anonymous>)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at fetch (/workspace/node_modules/@remix-run/web-fetch/src/fetch.js:41:9)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at MCPClient._makeJsonRpcRequest (file:///workspace/build/server/index.js?t=315532801000:800:28)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at MCPClient.connectToStorefrontServer (file:///workspace/build/server/index.js?t=315532801000:666:35)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at action$3 (file:///workspace/build/server/index.js?t=315532801000:908:46)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at Object.callRouteAction (/workspace/node_modules/@remix-run/server-runtime/dist/data.js:36:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]     at /workspace/node_modules/@remix-run/router/router.ts:4934:19 {
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]   code: 'ERR_INVALID_URL',
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26]   input: 'your-store.myshopify.com/api/mcp'
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] }
[shop-chat-agent-whatsapp] [2025-07-28 12:34:26] WhatsApp: Failed to connect to MCP servers, continuing without tools: Invalid URL
[shop-chat-agent-whatsapp] [2025-07-28 12:34:31] POST /api/whatsapp-webhook 200 - - 5390.731 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:34:52] POST /api/whatsapp-webhook 200 - - 1.844 ms
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] WhatsApp: Error getting shop domain from database: PrismaClientValidationError: 
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] Invalid `prisma.session.findMany()` invocation:
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] 
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] {
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]   orderBy: {
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     createdAt: "desc",
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     ~~~~~~~~~
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   id?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   shop?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   state?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   isOnline?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   scope?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   expires?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   accessToken?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   userId?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   firstName?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   lastName?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   email?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   accountOwner?: SortOrder,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   locale?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   collaborator?: SortOrder | SortOrderInput,
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] ?   emailVerified?: SortOrder | SortOrderInput
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]   }
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] }
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] 
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] Unknown argument `createdAt`. Available options are marked with ?.
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     at An (/workspace/node_modules/@prisma/client/runtime/library.js:29:1363)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     at zn.handleRequestError (/workspace/node_modules/@prisma/client/runtime/library.js:121:7102)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     at zn.handleAndLogRequestError (/workspace/node_modules/@prisma/client/runtime/library.js:121:6784)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     at zn.request (/workspace/node_modules/@prisma/client/runtime/library.js:121:6491)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     at l (/workspace/node_modules/@prisma/client/runtime/library.js:130:9778)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     at action$3 (file:///workspace/build/server/index.js?t=315532801000:866:26)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     at Object.callRouteAction (/workspace/node_modules/@remix-run/server-runtime/dist/data.js:36:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     at /workspace/node_modules/@remix-run/router/router.ts:4934:19
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     at callLoaderOrAction (/workspace/node_modules/@remix-run/router/router.ts:4998:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]     at async Promise.all (index 0) {
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29]   clientVersion: '6.6.0'
[shop-chat-agent-whatsapp] [2025-07-28 12:40:29] }
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30] Failed to connect to MCP server:  TypeError: Invalid URL
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]     at new URL (node:internal/url:819:25)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]     at new Request (/workspace/node_modules/@remix-run/web-fetch/src/request.js:81:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]     at /workspace/node_modules/@remix-run/web-fetch/src/fetch.js:43:19
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]     at new Promise (<anonymous>)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]     at fetch (/workspace/node_modules/@remix-run/web-fetch/src/fetch.js:41:9)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]     at MCPClient._makeJsonRpcRequest (file:///workspace/build/server/index.js?t=315532801000:800:28)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]     at MCPClient.connectToStorefrontServer (file:///workspace/build/server/index.js?t=315532801000:666:35)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]     at action$3 (file:///workspace/build/server/index.js?t=315532801000:908:46)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]     at Object.callRouteAction (/workspace/node_modules/@remix-run/server-runtime/dist/data.js:36:16)
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]     at /workspace/node_modules/@remix-run/router/router.ts:4934:19 {
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]   code: 'ERR_INVALID_URL',
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30]   input: 'your-store.myshopify.com/api/mcp'
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30] }
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30] WhatsApp: Failed to connect to MCP servers, continuing without tools: Invalid URL
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30] WhatsApp: Attempting to connect to MCP servers...
[shop-chat-agent-whatsapp] [2025-07-28 12:40:30] Connecting to MCP server at your-store.myshopify.com/api/mcp
[shop-chat-agent-whatsapp] [2025-07-28 12:40:36] POST /api/whatsapp-webhook 200 - - 6511.955 ms